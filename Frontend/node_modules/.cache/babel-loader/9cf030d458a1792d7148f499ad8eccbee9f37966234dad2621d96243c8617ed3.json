{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import ChatList from'./ChatList';import{userChats}from'../actions/chatActions';import Chatbox from'./ChatBox';import{io}from\"socket.io-client\";import{useSelector}from\"react-redux\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function ChatLayout(){const user=useSelector(state=>state.auth.authData.result);const[currentChatList,setCurrentChatList]=useState(null);const[chatList,setChatList]=useState([]);const[onlineUsers,setOnlineUsers]=useState([]);const[sendMessage,setSendMessage]=useState(null);const[receivedMessage,setReceivedMessage]=useState(null);const socket=useRef();//user in dependencies to get live chat\nuseEffect(()=>{socket.current=io('https://lost-chatt-serger.onrender.com');socket.current.emit(\"new-user-add\",user._id);socket.current.on('get-users',users=>{setOnlineUsers(users);});},[user]);useEffect(()=>{getChatList();},[user._id]);// Send Message to socket server\nuseEffect(()=>{if(sendMessage!==null){socket.current.emit(\"send-message\",sendMessage);}},[sendMessage]);// Get the message from socket server\nuseEffect(()=>{socket.current.on(\"recieve-message\",data=>{console.log(data);setReceivedMessage(data);});},[]);const checkOnlineStatus=chat=>{const chatMember=chat.members.find(member=>member!==user._id);const online=onlineUsers.find(user=>user.userId===chatMember);return online?true:false;};const getChatList=async()=>{try{const chatListData=await userChats(user._id);setChatList(chatListData);}catch(error){console.log(error);}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"flex h-screen antialiased text-gray-800\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row h-full w-full overflow-x-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col py-8 pl-6 pr-2 w-64 bg-white flex-shrink-0 lg:sticky top-0\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-row items-center justify-center h-12 w-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center rounded-2xl text-indigo-700 bg-indigo-100 h-10 w-10\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",xmlns:\"http://www.w3.org/2000/svg\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:\"2\",d:\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-2 font-bold text-2xl\",children:\"Your Chats\"})]}),chatList&&chatList.map(chat=>/*#__PURE__*/_jsx(\"div\",{onClick:()=>setCurrentChatList(chat),children:/*#__PURE__*/_jsx(ChatList,{data:chat,loggedInUser:user._id,online:checkOnlineStatus(chat)},chat._id)}))]}),/*#__PURE__*/_jsx(Chatbox,{chat:currentChatList,loggedInUser:user._id,setSendMessage:setSendMessage,receivedMessage:receivedMessage})]})})});}","map":{"version":3,"names":["React","useState","useEffect","useRef","ChatList","userChats","Chatbox","io","useSelector","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ChatLayout","user","state","auth","authData","result","currentChatList","setCurrentChatList","chatList","setChatList","onlineUsers","setOnlineUsers","sendMessage","setSendMessage","receivedMessage","setReceivedMessage","socket","current","emit","_id","on","users","getChatList","data","console","log","checkOnlineStatus","chat","chatMember","members","find","member","online","userId","chatListData","error","children","className","fill","stroke","viewBox","xmlns","strokeLinecap","strokeLinejoin","strokeWidth","d","map","onClick","loggedInUser"],"sources":["/Users/rohit/Desktop/lost/Frontend/src/components/ChatLayout.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport ChatList from './ChatList';\nimport { userChats } from '../actions/chatActions';\nimport Chatbox from './ChatBox'\nimport { io } from \"socket.io-client\";\nimport { useSelector } from \"react-redux\";\n\nexport default function ChatLayout() {\n\n  const user = useSelector((state) => state.auth.authData.result);\n  \n  const [currentChatList, setCurrentChatList] = useState(null);\n  const [chatList, setChatList] = useState([]);\n  const [onlineUsers, setOnlineUsers] = useState([]);\n  const [sendMessage, setSendMessage] = useState(null);\n  const [receivedMessage, setReceivedMessage] = useState(null);\n  const socket = useRef();\n\n  //user in dependencies to get live chat\n  useEffect(() => {\n    socket.current =io('https://lost-chatt-serger.onrender.com')\n    socket.current.emit(\"new-user-add\", user._id);\n    socket.current.on('get-users',(users)=>{\n      setOnlineUsers(users);\n      \n    })\n  }, [user])\n  \n\n  useEffect(() => {\n    getChatList();\n  }, [user._id]);\n\n\n  // Send Message to socket server\n  useEffect(() => {\n    if (sendMessage!==null) {\n      socket.current.emit(\"send-message\", sendMessage);}\n  }, [sendMessage]);\n\n\n  // Get the message from socket server\n  useEffect(() => {\n    socket.current.on(\"recieve-message\", (data) => {\n      console.log(data)\n      setReceivedMessage(data);\n    }\n    );\n  }, []);\n\n  const checkOnlineStatus = (chat) => {\n    const chatMember = chat.members.find((member) => member !== user._id);\n    const online = onlineUsers.find((user) => user.userId === chatMember);\n    return online ? true : false;\n  };\n\n  const getChatList = async () => {\n    try {\n      const chatListData = await userChats(user._id);\n      setChatList(chatListData);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  return (\n    <>\n    <div className=\"flex h-screen antialiased text-gray-800\">\n  <div className=\"flex flex-row h-full w-full overflow-x-hidden\">\n    <div className=\"flex flex-col py-8 pl-6 pr-2 w-64 bg-white flex-shrink-0 lg:sticky top-0\"> {/* Added lg:sticky and top-0 */}\n      <div className=\"flex flex-row items-center justify-center h-12 w-full\">\n        <div className=\"flex items-center justify-center rounded-2xl text-indigo-700 bg-indigo-100 h-10 w-10\">\n          <svg\n            className=\"w-6 h-6\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth=\"2\"\n              d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\"\n            ></path>\n          </svg>\n        </div>\n        <div className=\"ml-2 font-bold text-2xl\">Your Chats</div>\n      </div>\n      {/* chatList */}\n      {chatList && chatList.map((chat) => (\n        <div onClick={() => \n        \n        setCurrentChatList(chat)}>\n          <ChatList key={chat._id} data={chat} loggedInUser={user._id} online={checkOnlineStatus(chat)} />\n        </div>\n      ))}\n    </div>\n\n    {/* Chatbox */}\n    <Chatbox chat={currentChatList} loggedInUser={user._id} setSendMessage={setSendMessage} receivedMessage={receivedMessage}></Chatbox>\n  </div>\n</div>\n\n\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}